<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Virushka's Wedding</title>
    <link href="festora.css" rel="stylesheet" >
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Dancing+Script:wght@700&display=swap" rel="stylesheet">
    <style>html { scroll-behavior: smooth; }</style>
    
</head>
<body>
    <header class="site-header">
    <div class="logo-container">
        <img src="festora_logo.png" alt="Festora Logo" style="height: 100px; margin-right: 15px;">
        <h1 style="font-family: 'Georgia', cursive; font-size: 30px; color: #4b2e2e;">Festora</h1>
    </div>
    <nav class="main-nav">
        <a href="festora.html" class="active-link">Home</a> <!-- Added active link -->
        <a href="events.html">Events</a> <!-- Changed to scroll link -->
        <a href="photos.html">Photos</a>
        <a href="stayinfo.html">Stay Info</a>
        <a href="#rsvpsection">RSVP</a>
        <a href="#" id="logout-btn" class="logout-link">Log Out</a>
    </nav>
</header>
    <div class="container">
        <div class="right">
            <div class="image-circle">
                <img src="https://i.pinimg.com/736x/8a/42/03/8a4203f8dfb43b57bec1fbfd2ef6bb48.jpg" alt="Wedding Couple">
            </div>
        <div class="left">
            <svg class="flourish-divider" width="100" height="20" viewBox="0 0 100 20" xmlns="http://www.w3.org/2000/svg"><path d="M 10 10 C 20 0, 30 0, 40 10 S 60 20, 70 10 S 80 0, 90 10" stroke="#d94f33" stroke-width="2" fill="none" stroke-linecap="round"/></svg>

            <h1>WELCOME TO<br>VIRUSHKA’S<br>WEDDING</h1>
            <p>6 June, 2025 at 5:00 PM | Sekhon Events Place</p>
            
            <!-- ADD CLASS "script-font" TO THIS DIV -->
            <div class="names script-font">Virat & Anushka</div>

            <!-- ADD THIS SVG FLOURISH -->
            <svg class="flourish-divider" width="100" height="20" viewBox="0 0 100 20" xmlns="http://www.w3.org/2000/svg"><path d="M 10 10 C 20 20, 30 20, 40 10 S 60 0, 70 10 S 80 20, 90 10" stroke="#d94f33" stroke-width="2" fill="none" stroke-linecap="round"/></svg>
        </div>
        </div>
    </div>
    <div style="background-color: #ffe6e1; padding: 40px;">
        <h2 style="color: #d94f33; font-family: Georgia, serif; font-size: 24px; margin-bottom: 30px;">LIST OF EVENTS
        </h2>
        <div style="display: flex; gap: 20px; flex-wrap: wrap; justify-content: center;">

            <div
                style="width: 300px ; background-color: white; text-align: center; box-shadow: 0 2px 4px rgba(0,0,0,0.1);">
                <a href="mehendi.html"><img src="https://i.pinimg.com/736x/f2/19/71/f2197128ef5cbe5a003944afe7697c2c.jpg" alt="Mehendi"
                    style="width: 100%; height: 250px; object-fit: cover;"></a>
                <p style="padding: 10px; margin: 0; font-weight: bold;">MEHENDI</p>
            </div>

            <div
                style="width: 300px; background-color: white; text-align: center; box-shadow: 0 2px 4px rgba(0,0,0,0.1);">
                <a href="sangeet.html"><img src="https://i.pinimg.com/736x/a8/1e/1f/a81e1fd8c1e93ff9488dcc5c3585280d.jpg" alt="Sangeet"
                    style="width: 100%; height: 250px; object-fit: cover;"></a>
                <p style="padding: 10px; margin: 0; font-weight: bold;">SANGEET</p>
            </div>

            <div
                style="width: 300px; background-color: white; text-align: center; box-shadow: 0 2px 4px rgba(0,0,0,0.1);">
                <img src="https://i.pinimg.com/736x/5b/4a/51/5b4a5179e61f959e64b9c73d1de0daa5.jpg" alt="Cocktail"
                    style="width: 100%; height: 250px; object-fit: cover;">
                <p style="padding: 10px; margin: 0; font-weight: bold;">COCKTAIL</p>
            </div>
        </div>
    </div>
    <div style="background-color: #ffe6e1; padding: 40px;">
        <div style="display: flex; gap: 20px; flex-wrap: wrap; justify-content: center;">
            <div
                style="width: 300px; background-color: white; text-align: center; box-shadow: 0 2px 4px rgba(0,0,0,0.1);">
                <a href= "haldi.html"><img src="https://i.pinimg.com/736x/1b/9b/46/1b9b4671a1fda7d67555cef845a8d9f6.jpg" alt="Haldi"
                    style="width: 100%; height: 250px; object-fit: cover;"></a>
                <p style="padding: 10px; margin: 0; font-weight: bold;">HALDI</p>
            </div>
            <div
                style="width: 300px; background-color: white; text-align: center; box-shadow: 0 2px 4px rgba(0,0,0,0.1);">
                <img src="https://i.pinimg.com/736x/e2/bf/3d/e2bf3d6020b1ff1da5d57d28c6df2e17.jpg" alt="Shaadi"
                    style="width: 100%; height: 250px; object-fit: cover;">
                <p style="padding: 10px; margin: 0; font-weight: bold;">SHAADI</p>
            </div>
        </div>
    </div>
    <!-- === NEW GEMINI AI WISH ASSISTANT SECTION === -->
    <section class="gemini-feature-section">
        <h2>✨ AI Wedding Wish Assistant</h2>
        <p>Not sure what to write in the card? Give our AI some ideas!</p>
        <div class="wish-generator-box">
            <label for="wishKeywords">Enter some keywords (e.g., "childhood friends, beautiful, lifetime of happiness"):</label>
            <input type="text" id="wishKeywords" placeholder="e.g., funny, dancing, congratulations">
            <button id="generateWishBtn">Generate Wish</button>
            <div id="wishLoading" style="display:none;">Generating your heartfelt wish...</div>
            <textarea id="wishResult" readonly placeholder="Your generated wedding wish will appear here..."></textarea>
            <button id="copyWishBtn" style="display:none;">Copy to Clipboard</button>
        </div>
    </section>
    <!-- === END NEW SECTION === -->
    <section id="rsvpsection" class="rsvp-section">
        <div class="rsvp-container">
          <div class="rsvp-image">
            <img src="https://i.pinimg.com/736x/1e/03/20/1e032078a82fa4b04500ff8caa863bfe.jpg" alt="Couple Photo" height="350px" />
          </div>
          <div class="rsvp-details">
            <h2>RSVP with us<br>before their big day!</h2>
            <p><strong>Phone</strong><br><span class="rsvp-box">(+91)456–7890</span></p>
            <p><strong>Email</strong><br><span class="rsvp-box">hello@reallygreatsite.com</span></p>
            <p><strong>Social</strong></p>
            <div class="social-icons">
                <a href="#"><img src="https://th.bing.com/th/id/OIP.2spOcwGpwKFSn-ZDDhdeIgHaHd?rs=1&pid=ImgDetMain" alt="Instagram" class="icon-circle"></a>
                <a href="#"><img src="https://www.pngkey.com/png/full/2-27646_twitter-logo-png-transparent-background-logo-twitter-png.png" alt="Twitter" class="icon-circle"></a>
                <a href="#"><img src="https://th.bing.com/th/id/OIP.i0iz1VjijKJLVqdiibW7LAHaHa?rs=1&pid=ImgDetMain" alt="Facebook" class="icon-circle"></a>
              </div>
          </div>
        </div>
      </section>
           
</body>
  <button onclick="scrollToTop()" style="position: fixed; bottom: 20px; right: 20px; background-color: #ffb3c6; color: white; border: none; border-radius: 50%; padding: 15px 20px; font-size: 18px; cursor: pointer; box-shadow: 0px 0px 10px rgba(0,0,0,0.2);">
    ↑
  </button>
  
  <script>
    function scrollToTop() {
      window.scrollTo({ top: 0, behavior: 'smooth' });
    }
  </script>    
  <!-- === NEW GEMINI API SCRIPT === -->
    <script type="module">
    // --- 1. FIREBASE IMPORTS ---
    import { initializeApp } from "https://www.gstatic.com/firebasejs/12.5.0/firebase-app.js";
    import { 
        getAuth, 
        onAuthStateChanged,
        signOut
    } from "https://www.gstatic.com/firebasejs/12.5.0/firebase-auth.js";
    
    const firebaseConfig = {
        apiKey: "AIzaSyAHRs1n--BpE6XclVAzJUxo4hdACXIXsaE",
        authDomain: "festorawebsite.firebaseapp.com",
        projectId: "festorawebsite",
        storageBucket: "festorawebsite.firebasestorage.app",
        messagingSenderId: "290693394977",
        appId: "1:290693394977:web:c68845e1c0ee7978f72960",
        measurementId: "G-2HC0CCB4JN"
    };

    const app = initializeApp(firebaseConfig);
    const auth = getAuth(app);

    document.addEventListener('DOMContentLoaded', () => {
        
        const logoutBtn = document.getElementById('logout-btn');

        onAuthStateChanged(auth, (user) => {
            if (user) {
                // User is signed in, they can stay.
                console.log("User is logged in:", user.email);
            } else {
                // No user is signed in. Redirect to login page.
                console.log("No user signed in. Redirecting to login page.");
                window.location.href = 'index.html'; 
            }
        });

        // B. Add listener for the logout button
        if (logoutBtn) {
            logoutBtn.addEventListener('click', (e) => {
                e.preventDefault(); // Stop the link from navigating
                signOut(auth).then(() => {
                    console.log("User signed out successfully.");
                    // onAuthStateChanged will catch this and redirect
                }).catch((error) => {
                    console.error("Sign out error:", error);
                });
            });
        }

    }); // End of Auth/Logout logic

    // --- 5. AI WEDDING WISH ASSISTANT LOGIC ---
    // (This is your existing code for the AI feature)

    // --- Configuration ---
    const API_KEY = "AIzaSyB3u9QYKiU0P2Ii5pr7ocQzjUJEr87AQ2E"; // <--- IMPORTANT: PASTE YOUR GEMINI API KEY HERE
    const TEXT_API_URL = `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-09-2025:generateContent?key=${API_KEY}`;
    const MAX_RETRIES = 3;

    // --- Text Generation API Call ---
    async function callGeminiApi(userPrompt, systemPrompt) {
        const payload = {
            contents: [{ parts: [{ text: userPrompt }] }],
            systemInstruction: {
                parts: [{ text: systemPrompt }]
            },
        };

        for (let i = 0; i < MAX_RETRIES; i++) {
            try {
                const response = await fetch(TEXT_API_URL, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(payload)
                });

                if (!response.ok) {
                    throw new Error(`API request failed with status ${response.status}`);
                }

                const result = await response.json();
                const candidate = result.candidates?.[0];

                if (candidate && candidate.content?.parts?.[0]?.text) {
                    return candidate.content.parts[0].text;
                } else {
                    throw new Error("Invalid response structure from API.");
                }
            } catch (error) {
                console.error(`Error calling Gemini API (Attempt ${i + 1}/${MAX_RETRIES}):`, error);
                if (i === MAX_RETRIES - 1) {
                    return "Error: Unable to generate text. Please try again later.";
                }
                await new Promise(resolve => setTimeout(resolve, 1000 * (i + 1))); // Exponential backoff
            }
        }
    }

    // --- Event Listeners for AI Wish Assistant ---
    document.addEventListener('DOMContentLoaded', () => {
        const generateWishBtn = document.getElementById('generateWishBtn');
        const wishKeywords = document.getElementById('wishKeywords');
        const wishLoading = document.getElementById('wishLoading');
        const wishResult = document.getElementById('wishResult');
        const copyWishBtn = document.getElementById('copyWishBtn');

        // 1. AI Wish Generator Button
        generateWishBtn.addEventListener('click', async () => {
            // Check for API Key first
            if (API_KEY === "") {
                wishResult.value = "Error: API Key is missing. Please add your API key to the script.";
                return;
            }
            
            const keywords = wishKeywords.value;
            if (!keywords) {
                wishResult.value = "Please enter some keywords first.";
                return;
            }

            wishLoading.style.display = 'block';
            wishResult.value = '';
            copyWishBtn.style.display = 'none';
            generateWishBtn.disabled = true;

            const userPrompt = `Write a short, heartfelt wedding wish (about 3-4 sentences) for Virat and Anushka. Base it on these ideas: ${keywords}`;
            const systemPrompt = "You are a helpful wedding guest assistant, skilled at writing warm and beautiful messages for wedding cards. You are writing for Virat and Anushka's wedding. Sign off with 'With warmest wishes,'";

            const generatedText = await callGeminiApi(userPrompt, systemPrompt);

            wishLoading.style.display = 'none';
            wishResult.value = generatedText;
            generateWishBtn.disabled = false;
            
            if (!generatedText.startsWith("Error:")) {
                 copyWishBtn.style.display = 'inline-block';
                 copyWishBtn.textContent = 'Copy to Clipboard';
            }
        });

        // 2. Copy Wish Button
        copyWishBtn.addEventListener('click', () => {
            wishResult.select();
            // Use document.execCommand as navigator.clipboard may be restricted in iframes
            try {
                document.execCommand('copy');
                copyWishBtn.textContent = 'Copied!';
            } catch (err) {
                console.error('Failed to copy text: ', err);
                copyWishBtn.textContent = 'Copy Failed';
            }
        });
    }); // End of AI Wish logic
</script>
</html>